# MFA 绕过

> 多因素身份验证（MFA）是一种安全措施，要求用户提供两个或多个验证因素才能访问系统、应用程序或网络。它结合了用户知道的内容（如密码）、用户拥有的内容（如手机或安全令牌），以及/或用户的生物特征（生物识别验证）。这种分层方法通过使未经授权的访问更加困难来增强安全性，即使密码被泄露也是如此。
> MFA 绕过是攻击者用来绕过多因素身份验证保护的技术。这些方法可能包括利用 MFA 实现中的漏洞、拦截身份验证令牌、利用社会工程学操纵用户或支持人员，或者利用基于会话的漏洞。

## 概述

* [响应篡改](#响应篡改)
* [状态码篡改](#状态码篡改)
* [响应中泄漏的 2FA 代码](#响应中泄漏的-2FA-代码)
* [JS 文件分析](#JS-文件分析)
* [2FA 代码可重复使用](#2FA-代码可重复使用)
* [缺乏暴力破解防护](#缺乏暴力破解防护)
* [缺少 2FA 代码完整性验证](#缺少-2FA-代码完整性验证)
* [在禁用 2FA 时的 CSRF](#在禁用-2FA-时的-CSRF)
* [密码重置禁用 2FA](#密码重置禁用-2FA)
* [滥用备份代码](#滥用备份代码)
* [在禁用 2FA 页面上的点击劫持](#在禁用-2FA-页面上的点击劫持)
* [启用 2FA 不会终止先前活动的会话](#启用-2FA-不会终止先前活动的会话)
* [通过强制浏览绕过 2FA](#通过强制浏览绕过-2FA)
* [通过 null 或 000000 绕过 2FA](#通过-null-或-000000-绕过-2FA)
* [通过数组绕过 2FA](#通过数组绕过-2FA)

## 2FA 绕过

### 响应篡改

如果响应为 `"success":false`  
将其更改为 `"success":true`

### 状态码篡改

如果状态码为 **4xx**  
尝试将其更改为 **200 OK** 并查看是否可以绕过限制

### 响应中泄漏的 2FA 代码

检查触发 2FA 代码请求的响应，查看代码是否泄漏。

### JS 文件分析

虽然很少见，但某些 JS 文件可能包含有关 2FA 代码的信息，值得一试。

### 2FA 代码可重复使用

相同的代码可以重复使用。

### 缺乏暴力破解防护

有可能暴力破解任何长度的 2FA 代码。

### 缺少 2FA 代码完整性验证

任何用户的代码都可以用于绕过 2FA。

### 在禁用 2FA 时的 CSRF

禁用 2FA 时没有 CSRF 防护，并且也没有身份验证确认。

### 密码重置禁用 2FA

更改密码/电子邮件时，2FA 将被禁用。

### 滥用备份代码

通过滥用备份代码功能绕过 2FA。  
使用上述提到的技术绕过备份代码以移除/重置 2FA 限制。

### 在禁用 2FA 页面上的点击劫持

将 2FA 禁用页面嵌入 iframe 中，并通过社会工程学诱使受害者禁用 2FA。

### 启用 2FA 不会终止先前活动的会话

如果会话已被劫持并且存在会话超时漏洞。

### 通过强制浏览绕过 2FA

如果应用程序在登录后重定向到 `/my-account` URL 而 2FA 已禁用，则尝试在 2FA 已启用时将 `/2fa/verify` 替换为 `/my-account` 来绕过验证。

### 通过 null 或 000000 绕过 2FA

输入代码 **000000** 或 **null** 以绕过 2FA 保护。

### 通过数组绕过 2FA

```json
{
    "otp":[
        "1234",
        "1111",
        "1337", // 正确的 OTP
        "2222",
        "3333",
        "4444",
        "5555"
    ]
}
```