# Microsoft SQL Server

:warning: 本页内容已移至 [InternalAllTheThings/cheatsheets/mssql-server-cheatsheet](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/)

- [工具](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#工具)
- [识别实例和数据库](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#识别实例和数据库)
    - [发现本地SQL Server实例](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#发现本地SQL Server实例)
    - [发现域内SQL Server实例](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#发现域内SQL Server实例)
    - [发现远程SQL Server实例](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#发现远程SQL Server实例)
    - [识别加密的数据库](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#识别加密的数据库)
    - [版本查询](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#版本查询)
- [识别敏感信息](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#识别敏感信息)
    - [从特定数据库获取表](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#从特定数据库获取表)
    - [从每个列收集5条记录](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#从每个列收集5条记录)
    - [从特定表收集5条记录](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#从特定表收集5条记录)
    - [将服务器的通用信息导出到文件](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#将服务器的通用信息导出到文件)
- [链接数据库](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#链接数据库)
    - [查找可信链接](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#查找可信链接)
    - [通过链接执行查询](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#通过链接执行查询)
    - [爬取域内的实例链接](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#爬取域内的实例链接)
    - [爬取特定实例的链接](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#爬取特定实例的链接)
    - [查询链接数据库的版本](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#查询链接数据库的版本)
    - [在链接数据库上执行存储过程](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#在链接数据库上执行存储过程)
    - [确定链接数据库的名称](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#确定链接数据库的名称)
    - [确定选定链接数据库的所有表名](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#确定选定链接数据库的所有表名)
    - [从选定的链接表中获取前5列](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#从选定的链接表中获取前5列)
    - [从选定的链接列中获取记录](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#从选定的链接列中获取记录)
- [通过xp_cmdshell执行命令](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#通过xp_cmdshell执行命令)
- [扩展存储过程](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#扩展存储过程)
    - [添加扩展存储过程并列出扩展存储过程](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#添加扩展存储过程并列出扩展存储过程)
- [CLR程序集](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#CLR程序集)
    - [使用CLR程序集执行命令](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#使用CLR程序集执行命令)
    - [手动创建CLR DLL并导入](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#手动创建CLR DLL并导入)
- [OLE自动化](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#OLE自动化)
    - [使用OLE自动化过程执行命令](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#使用OLE自动化过程执行命令)
- [代理作业](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#代理作业)
    - [通过SQL代理作业服务执行命令](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#通过SQL代理作业服务执行命令)
    - [列出所有作业](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#列出所有作业)
- [外部脚本](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#外部脚本)
    - [Python](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#Python)
    - [R](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#R)
- [审计检查](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#审计检查)
    - [查找并利用模拟机会](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#查找并利用模拟机会)
- [查找被配置为可信任的数据库](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#查找被配置为可信任的数据库)
- [手动SQL Server查询](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#手动SQL Server查询)
    - [查询当前用户并确定用户是否为sysadmin](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#查询当前用户并确定用户是否为sysadmin)
    - [当前角色](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#当前角色)
    - [当前数据库](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#当前数据库)
    - [列出所有表](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#列出所有表)
    - [列出所有数据库](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#列出所有数据库)
    - [服务器上的所有登录名](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#服务器上的所有登录名)
    - [数据库中的所有用户](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#数据库中的所有用户)
    - [列出所有sysadmin](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#列出所有sysadmin)
    - [列出所有数据库角色](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#列出所有数据库角色)
    - [来自服务器的有效权限](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#来自服务器的有效权限)
    - [来自数据库的有效权限](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#来自数据库的有效权限)
    - [查找可以对当前数据库进行模拟的SQL Server登录名](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#查找可以对当前数据库进行模拟的SQL Server登录名)
    - [利用模拟](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#利用模拟)
    - [利用嵌套模拟](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#利用嵌套模拟)
    - [MSSQL账户和哈希值](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#MSSQL账户和哈希值)
- [参考](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/mssql-server-cheatsheet/#参考)